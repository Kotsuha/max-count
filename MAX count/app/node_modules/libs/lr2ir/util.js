"use strict";

const querystring = require("querystring");

const MyPage = new (function MyPage() {
	this.getRivalIds = function($) {
		const $selfIntroTable = $("table").first(); // プレイヤーステータス table
		const $rivalRow = $("tr", $selfIntroTable).filter((i, el) => $("th", el).text() === "ライバル");
		let ids = [];
		$("a", $rivalRow).each(function(i, el) {
			const href = $(el).prop("href");
			const playerid = querystring.parse(href).playerid;
			ids.push(playerid);
		});
		return ids;
	};
})();

const MyList = new function MyList() {
	this.getTable = function($) {
		return $("table").first();
	};
}();

const SongRanking = new function SongRanking() {
	this.getRankingTable = function($) {
		return $("table").eq(3);
	};
}();

module.exports.MyPage = MyPage;
module.exports.MyList = MyList;
module.exports.SongRanking = SongRanking;
